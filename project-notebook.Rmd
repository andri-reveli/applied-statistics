---
title: "Projekt"
output: html_notebook
author:
    - Anisa Kapri
    - Andri Reveli
    - Dionis Hysko
date: 2021-06-01
---


## Hyrje

Librarite dhe paketat qe do te perdoren ne kete projekt:

```{r}
library(esquisse)
library(ggplot2)
library(reshape)
library(readxl)
library(Rcmdr)

source("scripts/clean.R")
source("scripts/utils.R")
```




```{r}
# test hi katror per pavaresine e hyrje daljeve nga viti

# read the data
x = read.csv2("datasets/tabela-e-hyrjeve.csv")

## convert to contigency table
#y = as.matrix(data.frame(x$Albania.citizens, x$Foreign.citizens))
#row.names(y) = x$Year
#colnames(y) = c("Shqiptare", "Te huaj")
#y = as.table(y)
print(x)

## chi square test
#chisq.test(y)
```


diagrami

```{r}
to_plot = data.frame(
    Viti = x$Year,
    Shqiptare = x$Albania.citizens,
    Te_huaj = x$Foreign.citizens
)
melted = melt(to_plot, id="Viti")

ggplot(
    melted, 
    aes(x = Viti, y = value, fill = variable)
) + 
    geom_bar(stat="identity",position = "dodge", alpha = 0.5) + 
    labs(y = "Hyrje", title = "Tabela e hyrjeve")
```

INTERPRETIM



Te dhenat vjetore

```{r}
# read data
hyrje = readXL(
    "datasets/tab-4.xlsx", 
    rownames=FALSE, 
    header=TRUE, 
    na="", 
    sheet="Sheet 1", 
    stringsAsFactors=TRUE
)

print(hyrje)

# build data frame for each year
hyrje2016 = build_vector(hyrje, 1, seq(2, 3))
hyrje2017 = build_vector(hyrje, 1, seq(4, 15))
hyrje2018 = build_vector(hyrje, 1, seq(16, 27))
hyrje2019 = build_vector(hyrje, 1, seq(28, 39))
hyrje2020 = build_vector(hyrje, 1, seq(40, 51))
hyrje2021 = build_vector(hyrje, 1, seq(52, 53))

year_based = list(hyrje2016, hyrje2017, hyrje2018, hyrje2019, hyrje2020, hyrje2021)
attributes(year_based) = list(
    names = c("2016", "2017", "2018", "2019", "2020", "2021"),
    row.names=1:length(x), 
    class='data.frame'
)

# plot
boxplot(year_based, xlab = "Viti", ylab = "Hyrje te shtetasve te huaj")
```


Te dhenat mujore

```{r}
# build data frame for each month

hyrje_jan = build_vector(hyrje, 1, seq(4, 53, 12))
hyrje_feb = build_vector(hyrje, 1, seq(5, 53, 12))
hyrje_mar = build_vector(hyrje, 1, seq(6, 53, 12))
hyrje_apr = build_vector(hyrje, 1, seq(7, 53, 12))
hyrje_may = build_vector(hyrje, 1, seq(8, 53, 12))
hyrje_jun = build_vector(hyrje, 1, seq(9, 53, 12))
hyrje_jul = build_vector(hyrje, 1, seq(10, 53, 12))
hyrje_aug = build_vector(hyrje, 1, seq(11, 53, 12))
hyrje_sep = build_vector(hyrje, 1, seq(12, 53, 12))
hyrje_oct = build_vector(hyrje, 1, seq(13, 53, 12))
hyrje_nov = build_vector(hyrje, 1, seq(2, 53, 12))
hyrje_dec = build_vector(hyrje, 1, seq(3, 53, 12))

month_based = list(
    hyrje_jan,
    hyrje_feb,
    hyrje_mar,
    hyrje_apr,
    hyrje_may,
    hyrje_jun,
    hyrje_jul,
    hyrje_aug,
    hyrje_sep,
    hyrje_oct,
    hyrje_nov,
    hyrje_dec
)
attributes(month_based) = list(
    names = c(
        "Janar",
        "Shkurt",
        "Mars",
        "Prill",
        "Maj",
        "Qershor",
        "Korrik",
        "Gusht",
        "Shtator",
        "Tetor",
        "Nentor",
        "Dhjetor"
    ),
    row.names=1:length(x), 
    class='data.frame'
)

boxplot(month_based, xlab = "Muaji", ylab = "Hyrje te shtetasve te huaj")
```


INTERPRETIM

Shenim: Injoro 2016 dhe 2021 sepse ka shume pak te dhena
