---
title: "Projekt"
output: html_notebook
author:
    - Anisa Kapri
    - Andri Reveli
    - Dionis Hysko
date: 2021-06-01
---


## Hyrje

Librarite dhe paketat qe do te perdoren ne kete projekt:

```{r}
library(ggplot2)
library(readxl)
library(dplyr)

source("scripts/clean.R")
source("scripts/utils.R")
```


## Analiza e hyrje daljeve per periudhen 2014 - 2021
```{r}
# Global constants
months = c("Janar", "Shkurt", "Mars", "Prill", "Maj", "Qershor", "Korrik", "Gusht", "Shtator", "Tetor", "Nentor", "Dhjetor")

years2016_2021 = c(2016, 2017, 2018, 2019, 2020, 2021)

currencies = c("GBP", "USD", "EUR", "CHF")
```


```{r}
# test hi katror per pavaresine e hyrje daljeve nga viti

# read the data
hyrje_dalje_vjetore = read_excel(
    path = "datasets/hyrje-dalje-vjetore.xlsx", 
    col_types = c("numeric", "numeric", "numeric", "text")
)

## convert to contigency table
#y = as.matrix(data.frame(x$Albania.citizens, x$Foreign.citizens))
#row.names(y) = x$Year
#colnames(y) = c("Shqiptare", "Te huaj")
#y = as.table(y)
print(hyrje_dalje_vjetore)

## chi square test
#chisq.test(y)
```

Reference [tabela e hyrje-daljeve vjetore].

### Trendi i hyrje-daljeve ne Shqiperi per periudhen 2014-2021 sipas shtetesise

diagrami

```{r}
ggplot(
    hyrje_dalje_vjetore, 
    aes(x = Viti, y = `Hyrje (total)`, fill = Shtetas)
) + 
    geom_bar(stat="identity",position = "dodge", alpha = 0.5) + 
    labs(y = "Hyrje", title = "Tabela e hyrjeve") + 
    coord_cartesian(ylim = c(0, 6500000))

ggplot(
    hyrje_dalje_vjetore, 
    aes(x = Viti, y = `Dalje (total)`, fill = Shtetas)
) + 
    geom_bar(stat="identity",position = "dodge", alpha = 0.5) + 
    labs(y = "Dalje", title = "Tabela e daljeve") + 
    coord_cartesian(ylim = c(0, 6500000))
```

INTERPRETIM



### Analiza e hyrjeve te shtetasve te huaj ne Shqiperi

#### Motivimi

/// TODO

```{r}

hyrje_mujore_te_huaj = read_excel(
    path = "datasets/hyrje-mujore-te-huaj.xlsx", 
    col_types = c("numeric", "numeric", "numeric")
)

print(hyrje_mujore_te_huaj)

ggplot(hyrje_mujore_te_huaj, aes(x = Viti, y = Vlera, group = Viti)) + 
    geom_boxplot(
        outlier.colour = "red", 
        outlier.shape = 1, 
        alpha = 0.5, 
        color = "black",
        fill = years2016_2021
    ) + 
    labs(
        title = "Hyrje te shtetasve te huaj per qellime pushimi, vizita etj",
        x = "Viti",
        y = "Hyrje" 
    )

```

Reference [hyrje te shtetasve te huaj].

Interpretim

Shenim: Injoro 2016 dhe 2021 sepse ka shume pak te dhena


Te dhenat mujore

```{r}
ggplot(hyrje_mujore_te_huaj, aes(x = Muaji, y = Vlera, group = Muaji)) + 
    geom_boxplot(outlier.colour = "red", outlier.shape = 1, alpha = 0.5, color = "black") + 
    labs(
        title = "Hyrje te shtetasve te huaj per qellime pushimi, vizita etj",
        x = "Muaji",
        y = "Hyrje" 
    ) + 
    scale_x_discrete(
        limit = factor(1:12), 
        labels = months
    )
```


INTERPRETIM


## Ndikimi i hyrjeve te shtetasve te huaj ne kursin e kembimit valutor

### Motivim

/// TODO

```{r}
kursi_i_kembimit_valutor_mujor = read_excel(
    path = "datasets/kursi-i-kembimit-valutor-mujor.xlsx", 
    col_types = c("text", "numeric", "numeric", "numeric")
)
print(kursi_i_kembimit_valutor_mujor)
ggplot(kursi_i_kembimit_valutor_mujor, aes(x = Muaji, y = `Vlera (ALL)`, group = Muaji)) + 
    geom_boxplot(outlier.colour = "red", outlier.shape = 1, alpha = 0.5, color = "black") + 
    labs(
        title = "Hyrje te shtetasve te huaj per qellime pushimi, vizita etj",
        x = "Muaji",
        y = "Hyrje" 
    ) + 
    facet_wrap(vars(Monedha))
```

Interpretim

Shihet nje renie gjate muajit te 5-te deri ne muajin e 10-te te vitit ne pergjithesi

/// TODO

```{r}
x = hyrje_mujore_te_huaj %>% 
    group_by(Muaji) %>% 
    summarise_at(
        vars(Vlera), 
        list(name = mean)
    )

monedha = data.frame(months)
for (curr in currencies) {
    el = kursi_i_kembimit_valutor_mujor %>% 
    filter(Monedha == curr) %>%
    group_by(Muaji) %>% 
    summarise_at(
        vars(`Vlera (ALL)`), 
        list(name = mean)
    )
    monedha[curr] = el$name
}


df = data.frame(
    muaji = months,
    hyrje = x$name,
    gbp = monedha$GBP,
    chf = monedha$CHF,
    eur = monedha$EUR,
    usd = monedha$USD
)

# gbp
ggplot(df) +
  aes(x = hyrje, y = gbp) +
  geom_point(
    shape = "circle",
    size = 2.5,
    colour = "#112446"
  ) +
  geom_smooth(span = 1L) +
  labs(
    x = "Hyrje mesatare mujore te shtetasve te huaj",
    y = "Vlera mesatare mujore e GBP",
    title = "Varesia e kursit te kembimit te GBP ndaj hyrjeve mujore"
  ) +
  theme_gray()

# chf
ggplot(df) +
  aes(x = hyrje, y = chf) +
  geom_point(shape = "circle", size = 2.5, colour = "#112446") +
  geom_smooth(span = 1L) +
  labs(
    x = "Hyrje mesatare mujore",
    y = "Vlera mesatare mujore CHF",
    title = "Varesia e CHF nga hyrjet mujore"
  ) +
  theme_gray()

# eur
ggplot(df) +
  aes(x = hyrje, y = eur) +
  geom_point(shape = "circle", size = 2.5, colour = "#112446") +
  geom_smooth(span = 1L) +
  labs(
    x = "Hyrje mujore",
    y = "Vlera e EUR",
    title = "Varesia e EUR nga hyrjet mesatare mujore"
  ) +
  theme_gray()

# usd
ggplot(df) +
  aes(x = hyrje, y = usd) +
  geom_point(shape = "circle", size = 2.5, colour = "#112446") +
  geom_smooth(span = 1L) +
  labs(
    x = "Hyrje mujore",
    y = "Vlera e USD",
    title = "Varesia e USD nga hyrjet mesatare mujore"
  ) +
  theme_gray()
```

Interpretim

Shihet se per vlera < 600.000 hyrje te turisteve te huaj ne nje muaj kursi i kembimit per monedhat e medha bie pothuajse ne menyre lineare. Per vlera > 600.000 ndikimi eshte teper i vogel perjastuar USD.





Reference [kursi i kembimit valutor].

## Referencat
[hyrje te shtetasve te huaj]: http://instat.gov.al/media/8157/tab-4.xlsx
[tabela e hyrje-daljeve vjetore]: http://instat.gov.al/media/7951/tab-2.xlsx 
[kursi i kembimit valutor]: https://www.bankofalbania.org/Statistikat/Statistikat_e_Sektorit_te_Jashtem/Kursi_i_kembimit/Kursi_mesatar_mujor.html


1. [http://instat.gov.al/media/8157/tab-4.xlsx](http://instat.gov.al/media/8157/tab-4.xlsx)
2. [http://instat.gov.al/media/8157/tab-2.xlsx](http://instat.gov.al/media/7951/tab-2.xlsx)
3. [https://www.bankofalbania.org/Statistikat/Statistikat_e_Sektorit_te_Jashtem/Kursi_i_kembimit/Kursi_mesatar_mujor.html](https://www.bankofalbania.org/Statistikat/Statistikat_e_Sektorit_te_Jashtem/Kursi_i_kembimit/Kursi_mesatar_mujor.html)
